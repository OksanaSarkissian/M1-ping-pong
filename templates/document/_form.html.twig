{{ form_start(form) }}
    {{ form_row(form.date) }}
    {% if documentType == 'devis' %}
    {{ form_row(form.delai) }}
    {% endif %}
    {{ form_row(form.client) }}
    {# {{ form_row(form.type) }} #}
    <label>Lignes</label>
    <ul class="ligneDocument" data-index="{{ form.ligneDocument|length > 0 ? form.ligneDocument|last.vars.name + 1 : 0 }}" data-prototype="{% if formType != 'edit' %}{{ form_widget(form.ligneDocument.vars.prototype)|e('html_attr') }}{% endif %}">
        {% for tag in form.ligneDocument %}
        {% for data in tag.vars.value %}
            <li class="d-flex">{{ dump(tag.vars.value.piece) }}</li>
        {% endfor %}
        {% endfor %}
    </ul>
<button type="button" class="add_item_link" data-collection-holder-class="ligneDocument">Ajouter une ligne</button>
{% if formType != 'new' %}
    {{ form_row(form.ligneDocument) }}
    {% endif %}
    {# {{ form_row(form.montant_total) }} #}

    <button class="btn">{{ button_label|default('Enregistrer') }}</button>
{# {{ form_end(form) }} #}

<script type="text/javascript">
    document
    .querySelectorAll('.add_item_link')
    .forEach(btn => {
        btn.addEventListener("click", addFormToCollection)
    });
    function addFormToCollection(e) {
        const collectionHolder = document.querySelector('.' + e.currentTarget.dataset.collectionHolderClass);
        console.log(collectionHolder)

        const item = document.createElement('li');

        item.innerHTML = collectionHolder
            .dataset
            .prototype
            .replace(
            /__name__/g,
            collectionHolder.dataset.index
            );

        collectionHolder.appendChild(item);

        collectionHolder.dataset.index++;
    };
</script>